import { action } from '@storybook/addon-actions';
import { Meta, Canvas, Story } from '@storybook/addon-docs/blocks';

import { UiKitModal, kitContext } from '.';
import { Demo } from './Demo';

<Meta
  title='UiKit/UiKitModal'
  parameters={{
    jest: ['UiKitModal/spec'],
  }}
  argTypes={{
    payload: { control: 'object' },
    errors: { control: 'object' },
    visible: { control: 'boolean' },
  }}
  decorators={[
    (storyFn) => (
      <kitContext.Provider
        value={{
          action: action('action'),
          state: action('state'),
          appId: 'core',
          errors: {},
        }}
      >
        {storyFn()}
      </kitContext.Provider>
    ),
  ]}
/>

# UI Kit Modal

<Canvas>
  <Story
    name='Input'
    args={{
      payload: [
        {
          type: 'input',
          element: {
            type: 'plain_text_input',
            actionId: 'input-test',
            placeholder: {
              type: 'plain_text_input',
              text: 'asdas',
            },
          },
          label: {
            type: 'plain_text',
            text: 'Label',
            emoji: true,
          },
        },
      ],
      errors: { 'input-test': 'asdas' },
      visible: true,
    }}
  >
    {({ payload, errors, visible }) => (
      <Demo visible={visible}>
        <kitContext.Provider
          value={{
            action: action('action'),
            state: action('state'),
            appId: 'core',
            errors,
          }}
        >
          {UiKitModal(payload)}
        </kitContext.Provider>
      </Demo>
    )}
  </Story>
</Canvas>

<Canvas>
  <Story
    name='Input Multiline'
    args={{
      payload: [
        {
          type: 'input',
          element: {
            type: 'plain_text_input',
            multiline: true,
            actionId: 'input-test',
          },
          label: {
            type: 'plain_text',
            text: 'Label',
            emoji: true,
          },
        },
      ],
      errors: { 'input-test': 'asdas' },
      visible: true,
    }}
  >
    {({ payload, errors, visible }) => (
      <Demo visible={visible}>
        <kitContext.Provider
          value={{
            action: action('action'),
            state: action('state'),
            appId: 'core',
            errors,
          }}
        >
          {UiKitModal(payload)}
        </kitContext.Provider>
      </Demo>
    )}
  </Story>
</Canvas>

<Canvas>
  <Story
    name='Input Datepicker'
    args={{
      payload: [
        {
          type: 'input',
          element: {
            type: 'datepicker',
            initial_date: '1990-04-28',
            actionId: 'input-test',
            placeholder: {
              type: 'plain_text',
              text: 'Select a date',
              emoji: true,
            },
          },
          label: {
            type: 'plain_text',
            text: 'Label',
            emoji: true,
          },
        },
      ],
      errors: { 'input-test': 'asdas' },
      visible: true,
    }}
  >
    {({ payload, errors, visible }) => (
      <Demo visible={visible}>
        <kitContext.Provider
          value={{
            action: action('action'),
            state: action('state'),
            appId: 'core',
            errors,
          }}
        >
          {UiKitModal(payload)}
        </kitContext.Provider>
      </Demo>
    )}
  </Story>
</Canvas>

<Canvas>
  <Story
    name='Image'
    args={{
      payload: [
        {
          type: 'image',
          title: {
            type: 'plain_text',
            text: 'Example Image',
            emoji: true,
          },
          imageUrl:
            'https://raw.githubusercontent.com/RocketChat/Rocket.Chat.Artwork/master/Logos/icon-circle-256.png',
          altText: 'Example Image',
        },
      ],
      errors: {},
      visible: true,
    }}
  >
    {({ payload, errors, visible }) => (
      <Demo visible={visible}>
        <kitContext.Provider
          value={{
            action: action('action'),
            state: action('state'),
            appId: 'core',
            errors,
          }}
        >
          {UiKitModal(payload)}
        </kitContext.Provider>
      </Demo>
    )}
  </Story>
</Canvas>

<Canvas>
  <Story
    name='confirm button'
    args={{
      payload: [
        {
          type: 'actions',
          elements: [
            {
              type: 'button',
              text: {
                type: 'plain_text',
                emoji: true,
                text: 'Approve',
              },
              confirm: {
                title: {
                  type: 'plain_text',
                  text: 'Are you sure?',
                },
                text: {
                  type: 'mrkdwn',
                  text: "Wouldn't you prefer a good game of _chess_?",
                },
                confirm: {
                  type: 'plain_text',
                  text: 'Do it',
                },
                deny: {
                  type: 'plain_text',
                  text: "Stop, I've changed my mind!",
                },
              },
              style: 'primary',
              value: 'click_me_123',
            },
            {
              type: 'button',
              text: {
                type: 'plain_text',
                emoji: true,
                text: 'Deny',
              },
              style: 'danger',
              value: 'click_me_123',
            },
          ],
        },
      ],
      errors: {},
      visible: true,
    }}
  >
    {({ payload, errors, visible }) => (
      <Demo visible={visible}>
        <kitContext.Provider
          value={{
            action: action('action'),
            state: action('state'),
            appId: 'core',
            errors,
          }}
        >
          {UiKitModal(payload)}
        </kitContext.Provider>
      </Demo>
    )}
  </Story>
</Canvas>

<Canvas>
  <Story
    name='Poll'
    args={{
      payload: [
        {
          type: 'input',
          element: {
            type: 'plain_text_input',
          },
          label: {
            type: 'plain_text',
            text: 'Insert your question',
            emoji: true,
          },
        },
        {
          type: 'divider',
        },
        {
          type: 'section',
          text: {
            type: 'mrkdwn',
            text: '*Add some choices*',
          },
        },
        {
          type: 'input',
          element: {
            type: 'plain_text_input',
          },
          label: {
            type: 'plain_text',
            text: 'Question 1',
            emoji: true,
          },
        },
        {
          type: 'input',
          optional: true,
          element: {
            type: 'plain_text_input',
          },
          label: {
            type: 'plain_text',
            text: 'Question 2',
          },
        },
      ],
      errors: {},
      visible: true,
    }}
  >
    {({ payload, errors, visible }) => (
      <Demo visible={visible}>
        <kitContext.Provider
          value={{
            action: action('action'),
            state: action('state'),
            appId: 'core',
            errors,
          }}
        >
          {UiKitModal(payload)}
        </kitContext.Provider>
      </Demo>
    )}
  </Story>
</Canvas>

<Canvas>
  <Story
    name='live button'
    args={{
      payload: [],
      errors: {},
      visible: true,
    }}
  >
    {({ payload, errors, visible }) => (
      <Demo visible={visible}>
        <kitContext.Provider
          value={{
            action: action('action'),
            state: action('state'),
            appId: 'core',
            errors,
          }}
        >
          {UiKitModal(payload)}
        </kitContext.Provider>
      </Demo>
    )}
  </Story>
</Canvas>
